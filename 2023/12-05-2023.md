<h2>Filter</h2>

XSS 방어코드를 필터 레이어에서 구현하다가 문득 `FilterChain`의 `doFilter()` 메서드에 의문이 생겼다.   

**"뭐하는 녀석이지?"**   

`Filter`를 우선 쉽게 이해하자면 클라이언트의 요청이 서버 사이드에 접근하게 되면 가장 먼저 처리되는 작업이라고 할 수 있겠다. 필터 레이어에서 클라이언트가 보낸 요청을 커스텀할 수 있고 필터는 여러 개가 존재할 수 있다. 특이한 점은 여러 개의 필터가 순차적인 순서를 가지고 있고 **_(그래서 XSS 라이브러리인 Lucy의 가이드 메뉴얼에서는 EncodingFilter의 뒷 순서에 Lucy 관련 필터 설정을 하도록 기재되어 있다)_** 메서드 체이닝처럼 연쇄적으로 작동하는 방식이다. `Servlet Container`의 구조에서 `Dispatcher Servlet` 이전에 실행되기 때문에 `Dispatcher Servlet`의 영향을 받지 않는다(이게 인터셉터와의 큰 차이점인 것이다). 그리고 `FilterChain`의 `doFilter()`는 앞서 말한 아직 실행되지 않은 필터들이 이어서 작동할 수 있게끔 체이닝을 지원한다. 실제로 XSS 필터를 구현하면서 실수로 `doFilter()` 메서드를 누락시킨 적이 있었는데 그냥 빈 페이지를 리턴받았었다.   

필터와 인터셉터가 하는 기능이 비슷하기 때문에 헷갈릴 수 있지만 `Servlet Container`의 동작 방식 및 순서를 이해하면 필터 레이어에서 처리할 기능과 인터셉터에서 처리할 기능을 개발자가 필요에 따라 잘 분별할 수 있을 것이다. 일단 나부터...